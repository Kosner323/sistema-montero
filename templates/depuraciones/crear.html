<!doctype html>
<html lang="es" data-pc-preset="preset-1" data-pc-sidebar-caption="true" data-pc-direction="ltr" dir="ltr" data-pc-theme="light">
<head>
    <meta charset="utf-8" />
    <title>Iniciar Proceso de Depuración | Portal Montero</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="icon" href="/assets/images/favicon.svg" type="image/x-icon" />

    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="/assets/fonts/phosphor/duotone/style.css" />
    <link rel="stylesheet" href="/assets/fonts/tabler-icons.min.css" />
    <link rel="stylesheet" href="/assets/fonts/feather.css" />
    <link rel="stylesheet" href="/assets/fonts/fontawesome.css" />
    <link rel="stylesheet" href="/assets/fonts/material.css" />
    <link rel="stylesheet" href="/assets/css/style.css" id="main-style-link" />
    <!-- ✅ REDISEÑO CORPORATIVO ENTERPRISE -->
    <link rel="stylesheet" href="/assets/css/corporate-redesign.css" />

    <style>
        .form-section-header {
            background-color: #f0f4f8;
            padding: 12px 15px;
            border-left: 4px solid #4680ff;
            margin-top: 25px;
            margin-bottom: 20px;
            font-weight: 600;
            font-size: 1.05rem;
        }
        .question-card {
            background-color: #f8f9fa;
            border-left: 3px solid #6c757d;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="loader-bg fixed inset-0 bg-white dark:bg-themedark-cardbg z-[1034]">
        <div class="loader-track h-[5px] w-full inline-block absolute overflow-hidden top-0">
            <div class="loader-fill w-[300px] h-[5px] bg-primary-500 absolute top-0 left-0 animate-[hitZak_0.6s_ease-in-out_infinite_alternate]"></div>
        </div>
    </div>

    {% include '_sidebar.html' %}
    {% include '_header.html' %}

    <div class="pc-container">
        <div class="pc-content">
            <div class="page-header">
                <div class="page-block">
                    <ul class="breadcrumb">
                        <li class="breadcrumb-item"><a href="/dashboard">Inicio</a></li>
                        <li class="breadcrumb-item"><a href="/depuraciones">Depuraciones</a></li>
                        <li class="breadcrumb-item" aria-current="page">Nueva Depuración</li>
                    </ul>
                    <div class="page-header-title">
                        <h5 class="mb-0">Iniciar Proceso de Depuración</h5>
                    </div>
                </div>
            </div>

            <!-- Mensaje de Feedback -->
            <div id="feedbackMessage" class="mb-3"></div>

            <!-- Alerta Informativa -->
            <div class="alert alert-info mb-4">
                <i data-feather="info" class="w-5 h-5 inline mr-2"></i>
                <strong>Nota Importante:</strong> Verificar que los documentos contengan el número de identificación y el nombre de la empresa,
                así como el tipo y número de identificación, nombre y apellido del usuario, y que toda la información coincida.
            </div>

            <div class="row">
                <div class="col-md-12">
                    <div class="card h-100">
                        <div class="card-header">
                            <h5><i data-feather="file-text" class="w-5 h-5 inline mr-2"></i>Preguntas Iniciales - Documentos Disponibles</h5>
                        </div>
                        <div class="card-body">
                            <form id="formDepuracion" enctype="multipart/form-data">

                                <div class="row g-4">
                                    <!-- Pregunta 1 -->
                                    <div class="col-md-6">
                                        <div class="card question-card">
                                            <div class="card-body">
                                                <label class="form-label fw-bold">1. ¿Existe cédula del usuario a depurar?</label>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="tiene_cedula" id="cedula_si" value="si">
                                                    <label class="form-check-label" for="cedula_si">✅ Sí</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="tiene_cedula" id="cedula_no" value="no" checked>
                                                    <label class="form-check-label" for="cedula_no">❌ No</label>
                                                </div>
                                                <div id="cedula_file_container" class="mt-2" style="display: none;">
                                                    <label class="form-label">Adjuntar Cédula (PDF):</label>
                                                    <input type="file" class="form-control" id="file_cedula" name="file_cedula" accept=".pdf">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Pregunta 2 -->
                                    <div class="col-md-6">
                                        <div class="card question-card">
                                            <div class="card-body">
                                                <label class="form-label fw-bold">2. ¿Existe un formulario de novedades de afiliación?</label>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="tiene_afiliacion" id="afiliacion_si" value="si">
                                                    <label class="form-check-label" for="afiliacion_si">✅ Sí</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="tiene_afiliacion" id="afiliacion_no" value="no" checked>
                                                    <label class="form-check-label" for="afiliacion_no">❌ No</label>
                                                </div>
                                                <div id="afiliacion_file_container" class="mt-2" style="display: none;">
                                                    <label class="form-label">Adjuntar Formulario de Afiliación (PDF):</label>
                                                    <input type="file" class="form-control" id="file_afiliacion" name="file_afiliacion" accept=".pdf">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Pregunta 3 -->
                                    <div class="col-md-6">
                                        <div class="card question-card">
                                            <div class="card-body">
                                                <label class="form-label fw-bold">3. ¿Existe una planilla con novedades de ingreso?</label>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="tiene_ingreso" id="ingreso_si" value="si">
                                                    <label class="form-check-label" for="ingreso_si">✅ Sí</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="tiene_ingreso" id="ingreso_no" value="no" checked>
                                                    <label class="form-check-label" for="ingreso_no">❌ No</label>
                                                </div>
                                                <div id="ingreso_file_container" class="mt-2" style="display: none;">
                                                    <label class="form-label">Adjuntar Planilla de Ingreso (PDF):</label>
                                                    <input type="file" class="form-control" id="file_ingreso" name="file_ingreso" accept=".pdf">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Pregunta 4 -->
                                    <div class="col-md-6">
                                        <div class="card question-card">
                                            <div class="card-body">
                                                <label class="form-label fw-bold">4. ¿Existe una planilla con novedades de retiro?</label>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="tiene_retiro" id="retiro_si" value="si">
                                                    <label class="form-check-label" for="retiro_si">✅ Sí</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="tiene_retiro" id="retiro_no" value="no" checked>
                                                    <label class="form-check-label" for="retiro_no">❌ No</label>
                                                </div>
                                                <div id="retiro_file_container" class="mt-2" style="display: none;">
                                                    <label class="form-label">Adjuntar Planilla de Retiro (PDF):</label>
                                                    <input type="file" class="form-control" id="file_retiro" name="file_retiro" accept=".pdf">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Nota para desarrollo futuro -->
                                <div class="alert alert-warning mt-4">
                                    <i data-feather="alert-triangle" class="w-5 h-5 inline mr-2"></i>
                                    <strong>Nota de Desarrollo:</strong> Esta es una versión simplificada del proceso de depuración.
                                    El wizard completo con múltiples pasos puede ser implementado en futuras versiones.
                                </div>

                                <!-- Botones de Acción -->
                                <div class="mt-4 d-flex justify-content-between gap-2">
                                    <a href="/depuraciones" class="btn btn-secondary">
                                        <i data-feather="x" class="w-4 h-4 inline mr-1"></i> Cancelar
                                    </a>
                                    <button type="submit" class="btn btn-primary" id="btnRegistrar">
                                        <i data-feather="save" class="w-4 h-4 inline mr-1"></i> Continuar
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {% include '_footer.html' %}

    <script src="/assets/js/plugins/simplebar.min.js"></script>
    <script src="/assets/js/plugins/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/assets/js/icon/custom-icon.js"></script>
    <script src="/assets/js/plugins/feather.min.js"></script>
    <script src="/assets/js/component.js"></script>
    <script src="/assets/js/theme.js"></script>
    <script>
        // --- POLYFILLS PARA TEMA (Ejecutar ANTES de script.js) ---
        // Previene errores de ReferenceError cuando script.js intenta llamar estas funciones
        window.layout_change = window.layout_change || function() {};
        window.layout_theme_sidebar_change = window.layout_theme_sidebar_change || function() {};
        window.change_box_container = window.change_box_container || function() {};
        window.layout_caption_change = window.layout_caption_change || function() {};
        window.layout_rtl_change = window.layout_rtl_change || function() {};
        window.preset_change = window.preset_change || function() {};
        window.main_layout_change = window.main_layout_change || function() {};
    </script>

    <script src="/assets/js/script.js"></script>

    {% include '_theme_config.html' %}

    <script>
        const feedbackDiv = document.getElementById('feedbackMessage');

        // Mostrar/ocultar contenedores de archivos según respuestas
        document.querySelectorAll('input[type="radio"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const name = this.name;
                const value = this.value;
                const containerId = name.replace('tiene_', '') + '_file_container';
                const container = document.getElementById(containerId);

                if (container) {
                    container.style.display = value === 'si' ? 'block' : 'none';
                }
            });
        });

        // Manejar envío del formulario
        document.getElementById('formDepuracion').addEventListener('submit', function(e) {
            e.preventDefault();

            // Por ahora, solo mostrar un mensaje
            // En producción, aquí se enviaría el formulario al backend
            showMessage('Funcionalidad en desarrollo. El wizard completo será implementado próximamente.', 'info');
        });

        function showMessage(message, type = 'info') {
            if (feedbackDiv) {
                feedbackDiv.innerHTML = `<div class="alert alert-${type} alert-dismissible fade show" role="alert">
                                          ${message}
                                          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                                       </div>`;
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            feather.replace();
        });
    </script>
</body>
</html>
